<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: login.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: login.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Array to store user objects.
 * @type {Array&lt;{email: string, password: string}>}
 */
let users = [];

/**
 * The current user object.
 * @type {Array}
 */
let user = [];

/**
 * Initializes the login process by loading users.
 * @async
 */
async function initLogIn() {
    await loadUsers();
}

/**
 * Navigates to the sign-in page.
 */
function navToSignIn() {
    window.location.href = "../../html/user-login/sign-in.html";
}

/**
 * Handles guest login by clearing the current user and redirecting to the summary page.
 * @async
 */
async function guestLogIn() {
    user = [];
    await setItem("user", JSON.stringify(user));
    window.location.href = "../../html/summary.html";
}

/**
 * Loads users from storage.
 * Tries to parse the "users" item from storage. If it exists and is an array, it sets the users variable.
 * Otherwise, initializes users with an empty array.
 * @async
 */
async function loadUsers() {
    try {
        let loadedUsers = JSON.parse(await getItem("users"));
        if (Array.isArray(loadedUsers)) {
            users = loadedUsers;
        } else {
            users = [];
        }
    } catch (error) {
        console.error("Fehler beim Laden der Benutzer: ", error);
        users = [];
    }
}

/**
 * Performs the login by validating the entered email and password against the loaded users.
 * If the user is found, it saves the user to storage and navigates to the summary page.
 * Otherwise, it displays an error message.
 * @async
 */
async function logIn() {
    let email = document.getElementById("emailInput").value;
    let password = document.getElementById("passwordInput").value;

    user = users.find((user) => user.email === email &amp;&amp; user.password === password);

    if (user) {
        await setItem("user", JSON.stringify(user));
        window.location.href = "../../html/summary.html";
    } else {
        let failureText = document.getElementById("failureTextInLogin");
        failureText.innerHTML = "Email or password are incorrect";
    }
}

/**
 * Sets up event listeners on DOMContentLoaded event to clear failure messages upon input field interaction.
 */
document.addEventListener("DOMContentLoaded", function () {
    let inputs = document.getElementsByClassName("input");
    for (let i = 0; i &lt; inputs.length; i++) {
        inputs[i].addEventListener("click", function () {
            document.getElementById("failureTextInLogin").innerHTML = "";
        });
    }
});

document.addEventListener("DOMContentLoaded", function () {
    let passwordInput = document.getElementById("passwordInput");
    let toggleIcon = document.getElementById("togglePasswordVisibility");
    toggleIcon.addEventListener("click", function () {
        if (passwordInput.type === "password") {
            passwordInput.type = "text";
            toggleIcon.src = "../../img/visibility.png"; 
        } else {
            passwordInput.type = "password";
            toggleIcon.src = "../../img/visibility-off.png"; 
        }
    });
    passwordInput.addEventListener("input", function () {
        if (passwordInput.value === "") {
            toggleIcon.src = "../../img/lock.svg"; 
            passwordInput.type = "password";
        }
    });
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#guestLogIn">guestLogIn</a></li><li><a href="global.html#initLogIn">initLogIn</a></li><li><a href="global.html#loadUsers">loadUsers</a></li><li><a href="global.html#logIn">logIn</a></li><li><a href="global.html#navToSignIn">navToSignIn</a></li><li><a href="global.html#user">user</a></li><li><a href="global.html#users">users</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Tue Nov 05 2024 11:01:19 GMT+0100 (Mitteleurop√§ische Normalzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
